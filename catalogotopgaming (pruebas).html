
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Catálogo Top Gaming</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body {
      background-color: #121212;
      font-family: 'Orbitron', sans-serif;
      color: white;
    }
    .active-filter {
      background-color: #06b6d4 !important;
      color: #000 !important;
    }
    .banner-header {
  background-image: url("https://res.cloudinary.com/dlgwd3dsq/image/upload/v1755046872/Copia_de_Purple_Green_Futuristic_Modern_E-Sports_Gaming_Presentation_20250812_220049_0000_qlghzy.png");
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  height: 250px;
}
  </style>
</head>
<body>
 <header class="text-center py-6 bg-black border-b border-gray-800 banner-header">
  
</header>
<main class="container mx-auto py-10 px-4">
  <h1 class="text-4xl text-center font-bold text-cyan-400 mb-6">Catálogo</h1>

  <!-- Menú plegable de categorías -->
  <div class="relative flex justify-center mb-8">
    <div class="relative inline-block text-left w-64">
      <button id="dropdownButton"
        class="inline-flex justify-between w-full rounded-lg border border-cyan-700 bg-gray-900 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-gray-800 focus:outline-none">
        Seleccionar Categoría
        <svg class="w-5 h-5 ml-2 -mr-1 text-gray-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
          stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M19 9l-7 7-7-7" />
        </svg>
      </button>

      <!-- Lista de categorías -->
      <div id="dropdownMenu"
        class="absolute z-10 mt-2 w-full origin-top-right rounded-lg bg-gray-900 shadow-lg ring-1 ring-black ring-opacity-5 hidden">
        <div id="category-buttons" class="py-2 max-h-64 overflow-y-auto">
          <!-- Aquí se inyectan las categorías desde JS -->
        </div>
      </div>
    </div>
  </div>

  <!-- Subcategorías -->
  <div id="subcategory-buttons" class="flex flex-wrap justify-center gap-2 mb-8"></div>

  <!-- Productos -->
  <div id="products-grid" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6"></div>
</main>

<script>
  // Toggle del menú desplegable
  const dropdownButton = document.getElementById('dropdownButton');
  const dropdownMenu = document.getElementById('dropdownMenu');

  dropdownButton.addEventListener('click', () => {
    dropdownMenu.classList.toggle('hidden');
  });

  // Cierra el menú si clickeas fuera
  document.addEventListener('click', (event) => {
    if (!dropdownButton.contains(event.target) && !dropdownMenu.contains(event.target)) {
      dropdownMenu.classList.add('hidden');
    }
  });

  // Función para renderizar supercategorías en el dropdown
  function renderizarSupercategorias(supercategorias) {
    const categoryList = document.getElementById("category-list");
    categoryList.innerHTML = "";

    supercategorias.forEach(supercat => {
      const item = document.createElement("button");
      item.className = "block w-full text-left px-4 py-2 text-sm text-white hover:bg-gray-800";
      item.textContent = supercat;
      item.addEventListener("click", () => {
        filtrarPorSupercategoria(supercat);
        dropdownMenu.classList.add('hidden');
        dropdownButton.innerHTML = `${supercat}
          <svg class="w-5 h-5 ml-2 -mr-1 text-gray-400 inline-block float-right" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
          </svg>`;
      });
      categoryList.appendChild(item);
    });
  }
</script>
  
  <script>
const csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vReeeaHPGsf6OkMxl1KE7CzVNSisc-vhgTDKY1t8zN53Tk_hixo8RyRnZ-OfMfhAbmvRATPbStGgPvP/pub?output=csv";
let productos = [];
let supercategoriaActiva = "Todas";
let categoriaActiva = "Todas";
let paginaActual = 1;
const productosPorPagina = 12;

async function cargarProductos() {
  const response = await fetch(`https://api.allorigins.win/raw?url=${encodeURIComponent(csvUrl)}`);
  const data = await response.text();
  const rows = data.trim().split("\n");
  productos = [];

  for (let i = 1; i < rows.length; i++) {
    const [nombre, precio, imagen, categoria, supercategoria, stock] = rows[i].split(",");
    if (stock && stock.trim() === "1") {
      productos.push({
        nombre: nombre.trim(),
        precio: parseFloat(precio.trim()),
        imagen: imagen.trim(),
        categoria: categoria.trim(),
        supercategoria: supercategoria.trim()
      });
    }
  }

  renderizarSupercategorias();
  renderizarCategorias();
  renderizarProductos();
}

function renderizarSupercategorias() {
  const contenedor = document.getElementById("category-buttons");
  contenedor.innerHTML = "";

  const supercategorias = ["Todas", ...new Set(productos.map(p => p.supercategoria))];

  supercategorias.forEach(cat => {
    const btn = document.createElement("button");
    btn.textContent = cat;
    btn.className = "px-4 py-2 rounded border text-white border-cyan-400 hover:bg-cyan-600 transition";
    if (cat === supercategoriaActiva) btn.classList.add("active-filter");

    btn.onclick = () => {
      supercategoriaActiva = cat;
      categoriaActiva = "Todas";
      paginaActual = 1;
      renderizarSupercategorias();
      renderizarCategorias();
      renderizarProductos();
    };

    contenedor.appendChild(btn);
  });
}

function renderizarCategorias() {
  const contenedor = document.getElementById("subcategory-buttons");
  contenedor.innerHTML = "";

  if (supercategoriaActiva === "Todas") return;

  const categorias = ["Todas", ...new Set(
    productos
      .filter(p => p.supercategoria === supercategoriaActiva)
      .map(p => p.categoria)
  )];

  categorias.forEach(cat => {
    const btn = document.createElement("button");
    btn.textContent = cat;
    btn.className = "px-3 py-1 rounded border text-sm border-pink-400 text-pink-300 hover:bg-pink-500 hover:text-black transition";
    if (cat === categoriaActiva) btn.classList.add("active-filter");

    btn.onclick = () => {
      categoriaActiva = cat;
      paginaActual = 1;
      renderizarCategorias();
      renderizarProductos();
    };

    contenedor.appendChild(btn);
  });
}

function renderizarProductos() {
  const grid = document.getElementById("products-grid");
  grid.innerHTML = "";

  let filtrados = productos;

  if (supercategoriaActiva !== "Todas") {
    filtrados = filtrados.filter(p => p.supercategoria === supercategoriaActiva);
  }

  if (categoriaActiva !== "Todas") {
    filtrados = filtrados.filter(p => p.categoria === categoriaActiva);
  }

  // Paginación
  const inicio = (paginaActual - 1) * productosPorPagina;
  const fin = inicio + productosPorPagina;
  const productosPagina = filtrados.slice(inicio, fin);

  productosPagina.forEach(producto => {
    const card = document.createElement("div");
    card.className = "bg-gray-900 p-4 rounded-lg shadow flex flex-col";

    card.innerHTML = `
      <div class='h-48 bg-gray-800 rounded overflow-hidden mb-4'>
        <img src="${producto.imagen}" alt="${producto.nombre}" class="w-full h-full object-cover">
      </div>
      <h2 class="text-lg font-bold text-cyan-300 mb-2">${producto.nombre}</h2>
      <p class="text-pink-400 text-xl font-semibold mb-4">$ ${producto.precio.toLocaleString("es-AR")}</p>
      <a href="https://wa.me/5492996559907?text=Hola, quisiera consultar stock de ${encodeURIComponent(producto.nombre)}"
         class="mt-auto bg-green-500 hover:bg-green-600 text-black font-bold py-2 px-4 rounded text-center flex items-center justify-center gap-2">
        <i class="fab fa-whatsapp"></i> Consultar por WhatsApp
      </a>
    `;

    grid.appendChild(card);
  });

  renderizarPaginacion(filtrados.length);
}

function renderizarPaginacion(totalProductos) {
  const contenedor = document.getElementById("pagination") || document.createElement("div");
  contenedor.id = "pagination";
  contenedor.className = "flex justify-center mt-6 gap-2";

  contenedor.innerHTML = "";
  const totalPaginas = Math.ceil(totalProductos / productosPorPagina);

  // Botón Anterior
  const btnAnterior = document.createElement("button");
  btnAnterior.textContent = "Anterior";
  btnAnterior.disabled = paginaActual === 1;
  btnAnterior.className = `px-3 py-1 rounded ${paginaActual === 1 ? "bg-gray-500 text-gray-300 cursor-not-allowed" : "bg-gray-700 text-white hover:bg-cyan-400"}`;
  btnAnterior.onclick = () => {
    if (paginaActual > 1) {
      paginaActual--;
      renderizarProductos();
      window.scrollTo({ top: 0, behavior: "smooth" });
    }
  };
  contenedor.appendChild(btnAnterior);

  // Lógica para mostrar un rango limitado de páginas (máximo 5)
  let startPage = Math.max(1, paginaActual - 2);
  let endPage = Math.min(totalPaginas, startPage + 4);

  // Ajustar startPage si estamos cerca del final
  if (endPage - startPage < 4) {
    startPage = Math.max(1, endPage - 4);
  }

  for (let i = startPage; i <= endPage; i++) {
    const btn = document.createElement("button");
    btn.textContent = i;
    btn.className = `px-3 py-1 rounded ${i === paginaActual ? "bg-cyan-500 text-black" : "bg-gray-700 text-white"} hover:bg-cyan-400`;
    btn.onclick = () => {
      paginaActual = i;
      renderizarProductos();
      window.scrollTo({ top: 0, behavior: "smooth" });
    };
    contenedor.appendChild(btn);
  }

  // Botón Siguiente
  const btnSiguiente = document.createElement("button");
  btnSiguiente.textContent = "Siguiente";
  btnSiguiente.disabled = paginaActual === totalPaginas;
  btnSiguiente.className = `px-3 py-1 rounded ${paginaActual === totalPaginas ? "bg-gray-500 text-gray-300 cursor-not-allowed" : "bg-gray-700 text-white hover:bg-cyan-400"}`;
  btnSiguiente.onclick = () => {
    if (paginaActual < totalPaginas) {
      paginaActual++;
      renderizarProductos();
      window.scrollTo({ top: 0, behavior: "smooth" });
    }
  };
  contenedor.appendChild(btnSiguiente);

  if (!document.getElementById("pagination")) {
    document.querySelector("main").appendChild(contenedor);
  }
}

cargarProductos();
</script>

<footer class="bg-gray-900 text-white mt-10 p-6">
    <div class="max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-6">
        <div>
            <h2 class="text-lg font-bold mb-2">Top Gaming</h2>
            <p>Tu tienda gamer de confianza.</p>
        </div>
        <div>
            <h2 class="text-lg font-bold mb-2">Contacto</h2>
            <p>WhatsApp: <a href="https://wa.me/5492996559907" class="text-orange-400 hover:underline">+54 9 299 655 9907</a></p>
            <p>Email: contacto@topgaming.com</p>
        </div>
        <div>
            <h2 class="text-lg font-bold mb-2">Ubicación</h2>
            <p>Cipolletti, Río Negro, Argentina</p>
        </div>
    </div>
    <div class="text-center text-gray-400 mt-4 text-sm">
        © 2025 Top Gaming - Todos los derechos reservados
    </div>
</footer>
</body>
</html>
